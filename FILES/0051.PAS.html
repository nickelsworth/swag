<html>
<head><title> "INI File Handler" by DIRK PAESSLER</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to FILES SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0051.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#008000"><i>{**********************************************************************
 ** UNIT SETUP2                                                      **
 ** Handles an *.INI-File similiar to Windows                        **
 **********************************************************************
 ** The Setup-variables all have a unique name an can be retrieved   **
 ** by using the name. A default-value must be given when retrieving **
 ** a value, so that the returned value is always valid!             **
 ** There are different functions for different data types           **
 ** A BAK-file is created when touching the INI-file                 **
 ** For added speed a copy of the INI file is held in variable SETUP **
 **********************************************************************
 ** This is untested stuff, it runs flawlessly here in my programs   **
 ** (c) 1994 by Dirk Paessler, given to the public domain            **
 ** if you change anything please note; leave my name in here!!      **
 ** if you have questions or suggestions, please contact me          **
&Uacute;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Acirc;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Acirc;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&iquest;
&sup3; Dirk Paessler     &sup3;             &sup3; E-Mail:       FIDO 2:2490/1145.15 &sup3;
&sup3; Laerchenweg 8     &sup3;Fax          &sup3; CIS 100114,42      2:2490/2091.5  &sup3;
&sup3; D-91058 Erlangen  &sup3;+499131601169&sup3; internet 100114.42@compuserve.com &sup3;
&Agrave;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Aacute;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Aacute;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Ugrave;

 usage:

 USES setup2;
 VAR MyData:string;
 BEGIN
   Mydata:=GetStrProfile('MyData','nothing yet');
   WriteLn(mydata);
   PutStrProfile('MyData','New stuff');
   Mydata:=GetStrProfile('MyData','nothing yet');
   WriteLn(mydata);
 END.


 }

</i></font><font color="#FF0000"><b>UNIT </b></font>Setup2<font color="#000080">;
</font><font color="#FF0000"><b>INTERFACE
  
FUNCTION </b></font>GetIntProfile<font color="#000080">(</font>name<font color="#000080">:</font><font color="#FF0000"><b>STRING</b></font><font color="#000080">; </font><font color="#FF0000"><b>default</b></font><font color="#000080">:</font>INTEGER<font color="#000080">):</font>INTEGER<font color="#000080">;
</font><font color="#FF0000"><b>PROCEDURE </b></font>PutRealProfile<font color="#000080">(</font>name<font color="#000080">:</font><font color="#FF0000"><b>STRING</b></font><font color="#000080">; </font>wert<font color="#000080">:</font>REAL<font color="#000080">);
</font><font color="#FF0000"><b>FUNCTION </b></font>GetRealProfile<font color="#000080">(</font>name<font color="#000080">:</font><font color="#FF0000"><b>STRING</b></font><font color="#000080">; </font><font color="#FF0000"><b>default</b></font><font color="#000080">:</font>REAL<font color="#000080">):</font>REAL<font color="#000080">;
</font><font color="#FF0000"><b>PROCEDURE </b></font>PutStrProfile<font color="#000080">(</font>name<font color="#000080">,</font>wert<font color="#000080">:</font><font color="#FF0000"><b>STRING</b></font><font color="#000080">);
</font><font color="#FF0000"><b>PROCEDURE </b></font>PutBoolProfile<font color="#000080">(</font>name<font color="#000080">:</font><font color="#FF0000"><b>STRING</b></font><font color="#000080">; </font>wert<font color="#000080">:</font>BOOLEAN<font color="#000080">);
</font><font color="#FF0000"><b>FUNCTION </b></font>GetStrProfile<font color="#000080">(</font>name<font color="#000080">,</font><font color="#FF0000"><b>default</b></font><font color="#000080">:</font><font color="#FF0000"><b>STRING</b></font><font color="#000080">):</font><font color="#FF0000"><b>STRING</b></font><font color="#000080">;
</font><font color="#FF0000"><b>FUNCTION </b></font>GetNumProfile<font color="#000080">(</font>name<font color="#000080">:</font><font color="#FF0000"><b>STRING</b></font><font color="#000080">):</font>REAL<font color="#000080">;
</font><font color="#FF0000"><b>FUNCTION </b></font>GetBoolProfile<font color="#000080">(</font>name<font color="#000080">:</font><font color="#FF0000"><b>STRING</b></font><font color="#000080">; </font><font color="#FF0000"><b>default</b></font><font color="#000080">:</font>BOOLEAN<font color="#000080">):</font>BOOLEAN<font color="#000080">;
  
</font><font color="#FF0000"><b>TYPE </b></font>PSetup <font color="#000080">= ^</font>Setuptype<font color="#000080">;
</font>SetupType <font color="#000080">= </font><font color="#FF0000"><b>ARRAY </b></font><font color="#000080">[</font><font color="#800000">1 </font><font color="#000080">.. </font><font color="#800000">70</font><font color="#000080">] </font><font color="#FF0000"><b>OF STRING</b></font><font color="#000080">[</font><font color="#800000">140</font><font color="#000080">];
  
</font><font color="#FF0000"><b>VAR   </b></font>Setup          <font color="#000080">: </font>PSetup<font color="#000080">;
</font><font color="#FF0000"><b>IMPLEMENTATION
  
VAR     </b></font>q<font color="#000080">:</font>INTEGER<font color="#000080">;
</font><font color="#FF0000"><b>CONST </b></font>anzsetups<font color="#000080">:</font>INTEGER<font color="#000080">=</font><font color="#800000">0</font><font color="#000080">;
  </font>newsetup<font color="#000080">:</font>BOOLEAN<font color="#000080">=</font>TRUE<font color="#000080">;
  
  
</font><font color="#FF0000"><b>FUNCTION </b></font>ReadALine<font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>Fil<font color="#000080">:</font>TEXT<font color="#000080">):</font><font color="#FF0000"><b>STRING</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>VAR </b></font>a<font color="#000080">:</font>CHAR<font color="#000080">; </font>b<font color="#000080">:</font><font color="#FF0000"><b>STRING</b></font><font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  </b></font>b<font color="#000080">:=</font><font color="#800000">''</font><font color="#000080">;
  </font>a<font color="#000080">:=</font><font color="#800000">#13</font><font color="#000080">;
  
  </font><font color="#FF0000"><b>WHILE </b></font><font color="#000080">(</font>a<font color="#000080">&lt;&gt;</font><font color="#800000">#10</font><font color="#000080">) </font><font color="#FF0000"><b>AND NOT </b></font><font color="#000080">(</font>EOF<font color="#000080">(</font>FIL<font color="#000080">)) </font><font color="#FF0000"><b>DO
  BEGIN
    IF </b></font>a<font color="#000080">&lt;&gt;</font><font color="#800000">#13 </font><font color="#FF0000"><b>THEN </b></font>b<font color="#000080">:=</font>b<font color="#000080">+</font>a<font color="#000080">;
    </font>Read<font color="#000080">(</font>fil<font color="#000080">,</font>a<font color="#000080">);
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font>ReadAline<font color="#000080">:=</font>b<font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  
</font><font color="#FF0000"><b>PROCEDURE </b></font>Zerleg<font color="#000080">(</font>a<font color="#000080">:</font><font color="#FF0000"><b>STRING</b></font><font color="#000080">; </font><font color="#FF0000"><b>VAR </b></font>b<font color="#000080">,</font>c<font color="#000080">:</font><font color="#FF0000"><b>STRING</b></font><font color="#000080">);
  </font><font color="#FF0000"><b>VAR </b></font>i<font color="#000080">:</font>INTEGER<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  </b></font>i<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
  </font><font color="#FF0000"><b>REPEAT
    </b></font>i<font color="#000080">:=</font>i<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">;
  </font><font color="#FF0000"><b>UNTIL </b></font><font color="#000080">(</font>a<font color="#000080">[</font>i<font color="#000080">]=</font><font color="#800000">'='</font><font color="#000080">) </font><font color="#FF0000"><b>OR </b></font><font color="#000080">(</font>i<font color="#000080">&gt;</font>length<font color="#000080">(</font>a<font color="#000080">));

  </font><font color="#FF0000"><b>IF </b></font>i<font color="#000080">&gt;</font>length<font color="#000080">(</font>a<font color="#000080">) </font><font color="#FF0000"><b>THEN </b></font>i<font color="#000080">:=</font>length<font color="#000080">(</font>a<font color="#000080">);
  </font>b<font color="#000080">:=</font>copy<font color="#000080">(</font>a<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font>i<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">);
  </font>c<font color="#000080">:=</font>copy<font color="#000080">(</font>a<font color="#000080">,</font>i<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">,</font>length<font color="#000080">(</font>a<font color="#000080">)-</font>i<font color="#000080">);
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>FileExist<font color="#000080">(</font>Fname<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">):</font>BOOLEAN<font color="#000080">;
</font><font color="#FF0000"><b>VAR </b></font>f<font color="#000080">:</font><font color="#FF0000"><b>file</b></font><font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
</b></font><font color="#008000"><i>{$I-}
  </i></font>Assign<font color="#000080">(</font>f<font color="#000080">,</font>fname<font color="#000080">);
  </font>Reset<font color="#000080">(</font>f<font color="#000080">);
  </font>Close<font color="#000080">(</font>f<font color="#000080">);
</font><font color="#008000"><i>{$I+}
  </i></font>FileExist <font color="#000080">:= (</font>IOResult<font color="#000080">=</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>fname<font color="#000080">&lt;&gt;</font><font color="#800000">''</font><font color="#000080">);
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;


</font><font color="#FF0000"><b>PROCEDURE </b></font>ReadSetup<font color="#000080">;
  </font><font color="#FF0000"><b>VAR </b></font>MyFil<font color="#000080">:</font>TEXT<font color="#000080">;</font>a<font color="#000080">,</font>myname<font color="#000080">,</font>wert<font color="#000080">:</font><font color="#FF0000"><b>STRING</b></font><font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  IF NOT </b></font>Fileexist<font color="#000080">(</font><font color="#800000">'astro5.ini'</font><font color="#000080">) </font><font color="#FF0000"><b>THEN
  BEGIN
    </b></font>Assign<font color="#000080">(</font>MyFil<font color="#000080">,</font><font color="#800000">'astro5.ini'</font><font color="#000080">);
    </font>Rewrite<font color="#000080">(</font>MyFil<font color="#000080">);
    </font>WriteLn<font color="#000080">(</font>MyFil<font color="#000080">,</font><font color="#800000">';  ***                    PSCS-Astro V5 INI                       ***'</font><font color="#000080">);
    </font>Close<font color="#000080">(</font>MyFil<font color="#000080">);
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>IF </b></font>Setup<font color="#000080">=</font><font color="#FF0000"><b>NIL THEN
  BEGIN
    </b></font>New<font color="#000080">(</font>setup<font color="#000080">);
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font>Assign<font color="#000080">(</font>MyFil<font color="#000080">,</font><font color="#800000">'astro5.ini'</font><font color="#000080">);
  </font>Reset<font color="#000080">(</font>MyFil<font color="#000080">);
  </font>q<font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">;
  </font><font color="#FF0000"><b>REPEAT
    REPEAT
      </b></font>a<font color="#000080">:=</font>ReadALine<font color="#000080">(</font>MyFil<font color="#000080">);
    </font><font color="#FF0000"><b>UNTIL </b></font><font color="#000080">(</font>a<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]&lt;&gt;</font><font color="#800000">';'</font><font color="#000080">) </font><font color="#FF0000"><b>OR </b></font><font color="#000080">(</font>eof<font color="#000080">(</font>myfil<font color="#000080">));
    </font>setup<font color="#000080">^[</font>q<font color="#000080">]:=</font>a<font color="#000080">;
    </font>q<font color="#000080">:=</font>q<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">;
  </font><font color="#FF0000"><b>UNTIL </b></font><font color="#000080">(</font>EOF<font color="#000080">(</font>MyFil<font color="#000080">));
  </font>anzsetups<font color="#000080">:=</font>q<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">;
  </font>Close<font color="#000080">(</font>MyFil<font color="#000080">);
  </font>NewSetup<font color="#000080">:=</font>FALSE<font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  
  
</font><font color="#FF0000"><b>FUNCTION </b></font>GetStrProfile<font color="#000080">(</font>name<font color="#000080">,</font><font color="#FF0000"><b>default</b></font><font color="#000080">:</font><font color="#FF0000"><b>STRING</b></font><font color="#000080">):</font><font color="#FF0000"><b>STRING</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>VAR </b></font>MyFil<font color="#000080">:</font>TEXT<font color="#000080">;</font>a<font color="#000080">,</font>myname<font color="#000080">,</font>wert<font color="#000080">:</font><font color="#FF0000"><b>STRING</b></font><font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  </b></font>GetStrProfile<font color="#000080">:=</font><font color="#FF0000"><b>default</b></font><font color="#000080">;
  
  </font><font color="#FF0000"><b>IF </b></font>Fileexist<font color="#000080">(</font><font color="#800000">'astro5.ini'</font><font color="#000080">) </font><font color="#FF0000"><b>THEN
  BEGIN
    IF </b></font>Setup<font color="#000080">=</font><font color="#FF0000"><b>NIL THEN
    BEGIN
      </b></font>New<font color="#000080">(</font>setup<font color="#000080">);
    </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>IF </b></font>NewSetup <font color="#FF0000"><b>THEN </b></font>ReadSetup<font color="#000080">;
    </font>q<font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">;
    </font><font color="#FF0000"><b>REPEAT
      </b></font>Zerleg<font color="#000080">(</font>setup<font color="#000080">^[</font>q<font color="#000080">],</font>MyName<font color="#000080">,</font>wert<font color="#000080">);
      </font>q<font color="#000080">:=</font>q<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">;
    </font><font color="#FF0000"><b>UNTIL </b></font><font color="#000080">(</font>name<font color="#000080">=</font>MyName<font color="#000080">) </font><font color="#FF0000"><b>OR </b></font><font color="#000080">(</font>q<font color="#000080">&gt;</font>anzsetups<font color="#000080">);
    </font><font color="#FF0000"><b>IF </b></font>name<font color="#000080">=</font>MyName <font color="#FF0000"><b>THEN </b></font>GetStrProfile<font color="#000080">:=</font>wert<font color="#000080">;
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  
</font><font color="#FF0000"><b>FUNCTION </b></font>GetBoolProfile<font color="#000080">(</font>name<font color="#000080">:</font><font color="#FF0000"><b>STRING</b></font><font color="#000080">; </font><font color="#FF0000"><b>default</b></font><font color="#000080">:</font>BOOLEAN<font color="#000080">):</font>BOOLEAN<font color="#000080">;
  </font><font color="#FF0000"><b>VAR </b></font>hlpstrg<font color="#000080">:</font><font color="#FF0000"><b>STRING</b></font><font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  </b></font>hlpstrg<font color="#000080">:=</font>GetStrProfile<font color="#000080">(</font>name<font color="#000080">,</font><font color="#800000">'t'</font><font color="#000080">);
  </font>GetBoolProfile <font color="#000080">:= </font><font color="#FF0000"><b>default</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>IF </b></font>hlpstrg<font color="#000080">=</font><font color="#800000">'TRUE' </font><font color="#FF0000"><b>THEN </b></font>GetBoolProfile <font color="#000080">:= </font>TRUE<font color="#000080">;
  </font><font color="#FF0000"><b>IF </b></font>hlpstrg<font color="#000080">=</font><font color="#800000">'FALSE' </font><font color="#FF0000"><b>THEN </b></font>GetBoolProfile <font color="#000080">:= </font>FALSE<font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  
</font><font color="#FF0000"><b>PROCEDURE </b></font>PutBoolProfile<font color="#000080">(</font>name<font color="#000080">:</font><font color="#FF0000"><b>STRING</b></font><font color="#000080">; </font>wert<font color="#000080">:</font>BOOLEAN<font color="#000080">);
  </font><font color="#FF0000"><b>VAR </b></font>hlpstrg<font color="#000080">:</font><font color="#FF0000"><b>STRING</b></font><font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  </b></font>hlpstrg<font color="#000080">:=</font><font color="#800000">'FALSE'</font><font color="#000080">;
  </font><font color="#FF0000"><b>IF </b></font>wert <font color="#FF0000"><b>THEN </b></font>hlpstrg<font color="#000080">:=</font><font color="#800000">'TRUE'</font><font color="#000080">;
  </font>PutStrProfile<font color="#000080">(</font>name<font color="#000080">,</font>hlpstrg<font color="#000080">);
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  
</font><font color="#FF0000"><b>FUNCTION </b></font>GetIntProfile<font color="#000080">(</font>name<font color="#000080">:</font><font color="#FF0000"><b>STRING</b></font><font color="#000080">; </font><font color="#FF0000"><b>default</b></font><font color="#000080">:</font>INTEGER<font color="#000080">):</font>INTEGER<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  </b></font>GetIntProfile<font color="#000080">:=</font>Round<font color="#000080">(</font>GetRealProfile<font color="#000080">(</font>name<font color="#000080">,</font><font color="#FF0000"><b>default</b></font><font color="#000080">*</font><font color="#800000">1.0</font><font color="#000080">));
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  
</font><font color="#FF0000"><b>FUNCTION </b></font>GetRealProfile<font color="#000080">(</font>name<font color="#000080">:</font><font color="#FF0000"><b>STRING</b></font><font color="#000080">; </font><font color="#FF0000"><b>default</b></font><font color="#000080">:</font>REAL<font color="#000080">):</font>REAL<font color="#000080">;
  </font><font color="#FF0000"><b>VAR </b></font>hlpstrg<font color="#000080">:</font><font color="#FF0000"><b>STRING</b></font><font color="#000080">; </font>i<font color="#000080">:</font>INTEGER<font color="#000080">; </font>a<font color="#000080">:</font>REAL<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  </b></font>str<font color="#000080">(</font><font color="#FF0000"><b>default</b></font><font color="#000080">,</font>hlpstrg<font color="#000080">);
  </font>hlpstrg<font color="#000080">:=</font>GetStrProfile<font color="#000080">(</font>name<font color="#000080">,</font>hlpstrg<font color="#000080">);
  </font>val<font color="#000080">(</font>hlpstrg<font color="#000080">,</font>a<font color="#000080">,</font>i<font color="#000080">);
  </font>GetRealProfile<font color="#000080">:=</font>a<font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  
</font><font color="#FF0000"><b>PROCEDURE </b></font>PutRealProfile<font color="#000080">(</font>name<font color="#000080">:</font><font color="#FF0000"><b>STRING</b></font><font color="#000080">; </font>wert<font color="#000080">:</font>REAL<font color="#000080">);
  </font><font color="#FF0000"><b>VAR </b></font>hlpstrg<font color="#000080">:</font><font color="#FF0000"><b>STRING</b></font><font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  </b></font>Str<font color="#000080">(</font>wert<font color="#000080">:</font><font color="#800000">1</font><font color="#000080">:</font><font color="#800000">10</font><font color="#000080">,</font>hlpstrg<font color="#000080">);
  </font>PutStrProfile<font color="#000080">(</font>name<font color="#000080">,</font>hlpstrg<font color="#000080">);
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  
  
</font><font color="#FF0000"><b>PROCEDURE </b></font>PutStrProfile<font color="#000080">(</font>name<font color="#000080">,</font>wert<font color="#000080">:</font><font color="#FF0000"><b>STRING</b></font><font color="#000080">);
  </font><font color="#FF0000"><b>VAR </b></font>MyFil<font color="#000080">,</font>my2fil<font color="#000080">,</font>my3fil<font color="#000080">:</font>TEXT<font color="#000080">;</font>a<font color="#000080">,</font>myname<font color="#000080">,</font>altwert<font color="#000080">,</font>Mywert<font color="#000080">:</font><font color="#FF0000"><b>STRING</b></font><font color="#000080">; </font>WasIt<font color="#000080">:</font>BOOLEAN<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  </b></font>altwert<font color="#000080">:=</font>getStrProfile<font color="#000080">(</font>name<font color="#000080">,</font><font color="#800000">'#*ÑîÅ'</font><font color="#000080">);
  </font><font color="#FF0000"><b>IF </b></font>altwert<font color="#000080">=</font>wert <font color="#FF0000"><b>THEN </b></font>exit<font color="#000080">;
  
  </font><font color="#FF0000"><b>IF NOT </b></font>Fileexist<font color="#000080">(</font><font color="#800000">'astro5.ini'</font><font color="#000080">) </font><font color="#FF0000"><b>THEN
  BEGIN
    </b></font>Assign<font color="#000080">(</font>MyFil<font color="#000080">,</font><font color="#800000">'astro5.ini'</font><font color="#000080">);
    </font>Rewrite<font color="#000080">(</font>MyFil<font color="#000080">);
    </font>WriteLn<font color="#000080">(</font>MyFil<font color="#000080">,</font><font color="#800000">';  ***                    PSCS-Astro V5 INI                       ***'</font><font color="#000080">);
    </font>Close<font color="#000080">(</font>MyFil<font color="#000080">);
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font>Assign<font color="#000080">(</font>MyFil<font color="#000080">,</font><font color="#800000">'astro5ini.tmp'</font><font color="#000080">);
  </font>Rewrite<font color="#000080">(</font>MyFil<font color="#000080">);
  </font>Assign<font color="#000080">(</font>My2Fil<font color="#000080">,</font><font color="#800000">'astro5.ini'</font><font color="#000080">);
  </font>ReSet<font color="#000080">(</font>My2Fil<font color="#000080">);
  </font>WasIt<font color="#000080">:=</font>FALSE<font color="#000080">;
  </font><font color="#FF0000"><b>REPEAT
    </b></font>a<font color="#000080">:=</font>ReadALine<font color="#000080">(</font>My2fil<font color="#000080">);
    </font>Zerleg<font color="#000080">(</font>a<font color="#000080">,</font>myname<font color="#000080">,</font>mywert<font color="#000080">);
    </font><font color="#FF0000"><b>IF </b></font>myname<font color="#000080">=</font>name <font color="#FF0000"><b>THEN BEGIN
      </b></font>WriteLn<font color="#000080">(</font>myfil<font color="#000080">,</font>name<font color="#000080">,</font><font color="#800000">'='</font><font color="#000080">,</font>wert<font color="#000080">);
      </font>WasIt<font color="#000080">:=</font>TRUE<font color="#000080">;
    </font><font color="#FF0000"><b>END
    ELSE </b></font>WriteLn<font color="#000080">(</font>myfil<font color="#000080">,</font>a<font color="#000080">)
  </font><font color="#FF0000"><b>UNTIL </b></font>EOF<font color="#000080">(</font>my2fil<font color="#000080">);
  </font><font color="#FF0000"><b>IF NOT </b></font>WasIt <font color="#FF0000"><b>THEN </b></font>WriteLn<font color="#000080">(</font>myfil<font color="#000080">,</font>name<font color="#000080">,</font><font color="#800000">'='</font><font color="#000080">,</font>wert<font color="#000080">);
  </font>Close<font color="#000080">(</font>MyFil<font color="#000080">);
  </font>Close<font color="#000080">(</font>My2Fil<font color="#000080">);
  </font><font color="#FF0000"><b>IF </b></font>Fileexist<font color="#000080">(</font><font color="#800000">'astro5.bak'</font><font color="#000080">) </font><font color="#FF0000"><b>THEN
  BEGIN
    </b></font>Assign <font color="#000080">(</font>my3fil<font color="#000080">,</font><font color="#800000">'astro5.bak'</font><font color="#000080">);
    </font>erase<font color="#000080">(</font>my3fil<font color="#000080">);
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font>Rename<font color="#000080">(</font>My2Fil<font color="#000080">,</font><font color="#800000">'astro5.bak'</font><font color="#000080">);
  </font>Rename<font color="#000080">(</font>MyFil<font color="#000080">,</font><font color="#800000">'astro5.ini'</font><font color="#000080">);
  </font>ReadSetup<font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  
</font><font color="#FF0000"><b>FUNCTION </b></font>GetNumProfile<font color="#000080">(</font>name<font color="#000080">:</font><font color="#FF0000"><b>STRING</b></font><font color="#000080">):</font>REAL<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
END</b></font><font color="#000080">;
  
</font><font color="#FF0000"><b>BEGIN
  
  
END</b></font><font color="#000080">.
  
</font><font color="#008000"><i>{be sure to insert the following line into your exit-code!!!}

</i></font><font color="#FF0000"><b>IF </b></font>setup<font color="#000080">&lt;&gt;</font><font color="#FF0000"><b>NIL THEN </b></font>Dispose<font color="#000080">(</font>setup<font color="#000080">);
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to FILES SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0051.PAS">Original</a><b>]</b></p></body>
</html>
