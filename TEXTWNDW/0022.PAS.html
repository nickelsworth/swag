<html>
<head><title> "Box drawing and scrolling" by PHILIPPE CADIC</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to TEXTWNDW SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0022.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
I've enclosed 2 SCROLL functions....
Hope it'll help.
These source are FREEWARE. So then can only be used in a Freeware or Shareware
. ( It'll be great if you give me a copy of your freeware).
These sources can be added to SWAGS....

&lt;==== Cut =====&gt; }

</i></font><font color="#FF0000"><b>Uses </b></font>CRT<font color="#000080">,</font>DOS <font color="#000080">...

</font><font color="#FF0000"><b>Procedure </b></font>Cadre <font color="#000080">(</font>X1<font color="#000080">,</font>X2<font color="#000080">,</font>Y1<font color="#000080">,</font>Y2<font color="#000080">,</font>FG<font color="#000080">,</font>BG<font color="#000080">:</font>Integer<font color="#000080">);

</font><font color="#008000"><i>{ Trace un Cadre entre les Coordonn‚es X1,Y1 et X2,Y2
  avec FG= Couleur du Cadre , BG= Couleur du Fond }

</i></font><font color="#FF0000"><b>Var
   </b></font>corner1<font color="#000080">,
   </font>corner2<font color="#000080">,
   </font>corner3<font color="#000080">,
   </font>corner4<font color="#000080">,
   </font>horizline<font color="#000080">,
   </font>vertline <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
   </font>a<font color="#000080">,</font>b<font color="#000080">: </font>integer<font color="#000080">;


   </font><font color="#FF0000"><b>Begin
               </b></font>corner1<font color="#000080">:=</font><font color="#800000">'&Uacute;'</font><font color="#000080">;
               </font>corner2<font color="#000080">:=</font><font color="#800000">'&iquest;'</font><font color="#000080">;
               </font>corner3<font color="#000080">:=</font><font color="#800000">'&Agrave;'</font><font color="#000080">;
               </font>corner4<font color="#000080">:=</font><font color="#800000">'&Ugrave;'</font><font color="#000080">;
               </font>horizline<font color="#000080">:=</font><font color="#800000">'&Auml;'</font><font color="#000080">;
               </font>vertline<font color="#000080">:=</font><font color="#800000">'&sup3;'</font><font color="#000080">;

        </font>TextColor <font color="#000080">(</font>FG<font color="#000080">);                  </font><font color="#008000"><i>{ Fixe les couleurs }
        </i></font>TextBackground <font color="#000080">(</font>BG<font color="#000080">);

        </font>GotoXY <font color="#000080">( </font>X1<font color="#000080">,</font>Y1 <font color="#000080">);                </font><font color="#008000"><i>{ Positionne le curseur }
      </i></font>Write <font color="#000080">(</font>Corner1<font color="#000080">);

      </font><font color="#FF0000"><b>For </b></font>a<font color="#000080">:= (</font>X1<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>to </b></font><font color="#000080">(</font>X2<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>do
       Begin                             </b></font><font color="#008000"><i>{ Ecrit le Cadre }
        </i></font>Write <font color="#000080">(</font>Horizline<font color="#000080">);
       </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

      </font>Write <font color="#000080">(</font>Corner2<font color="#000080">);


       </font><font color="#FF0000"><b>For </b></font>a<font color="#000080">:= (</font>Y1<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>to </b></font><font color="#000080">(</font>Y2<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>do
        Begin
         </b></font>GotoXY<font color="#000080">(</font>X1<font color="#000080">,</font>a<font color="#000080">);
         </font>Write <font color="#000080">(</font>VertLine<font color="#000080">);
         </font><font color="#FF0000"><b>For </b></font>b<font color="#000080">:= (</font>X1<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>to </b></font><font color="#000080">(</font>X2<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>do
          Begin
           </b></font>Write <font color="#000080">(</font><font color="#800000">' '</font><font color="#000080">);
          </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
         </font>Write<font color="#000080">(</font>Vertline<font color="#000080">);
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

      </font>GotoXY<font color="#000080">(</font>X1<font color="#000080">,</font>Y2<font color="#000080">);
      </font>Write <font color="#000080">(</font>Corner3<font color="#000080">);

      </font><font color="#FF0000"><b>For </b></font>a<font color="#000080">:= (</font>X1<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>to </b></font><font color="#000080">(</font>X2<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>do
       Begin
        </b></font>Write <font color="#000080">(</font>Horizline<font color="#000080">);
       </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

       </font>Write <font color="#000080">(</font>Corner4<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>Explode_Cadre <font color="#000080">(</font>X1<font color="#000080">,</font>X2<font color="#000080">,</font>Y1<font color="#000080">,</font>Y2<font color="#000080">,</font>FG<font color="#000080">,</font>BG<font color="#000080">,</font>Delai<font color="#000080">: </font>Integer<font color="#000080">);

</font><font color="#008000"><i>{ R‚daction: Explode_Cadre (X1,X2,Y1,Y2,FG,BG,Delai) }

  </i></font><font color="#FF0000"><b>Var

         </b></font>gauche<font color="#000080">,</font>droite<font color="#000080">,</font>MilieuX<font color="#000080">,
            </font>a<font color="#000080">,</font>b<font color="#000080">: </font>Integer<font color="#000080">;

  </font><font color="#FF0000"><b>Begin


   </b></font>MilieuX<font color="#000080">:= (</font>X1<font color="#000080">+</font>X2<font color="#000080">) </font><font color="#FF0000"><b>div </b></font><font color="#800000">2</font><font color="#000080">;         </font><font color="#008000"><i>{ Calcul des paramŠtres de position }
   </i></font>gauche<font color="#000080">:= (</font>X2<font color="#000080">-</font>X1<font color="#000080">) </font><font color="#FF0000"><b>div </b></font><font color="#800000">2</font><font color="#000080">;
   </font>droite<font color="#000080">:= </font>gauche<font color="#000080">;
   </font><font color="#FF0000"><b>if </b></font><font color="#000080">((</font>X2<font color="#000080">-</font>X1<font color="#000080">) </font><font color="#FF0000"><b>Mod </b></font><font color="#800000">2</font><font color="#000080">) &gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>Droite<font color="#000080">:= </font>Droite <font color="#000080">+</font><font color="#800000">1</font><font color="#000080">;

                                    </font><font color="#008000"><i>{ D‚but du Trac‚ }

   </i></font><font color="#FF0000"><b>For </b></font>a<font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>Gauche <font color="#FF0000"><b>do
    Begin
     </b></font>Cadre <font color="#000080">((</font>MilieuX<font color="#000080">-</font>a<font color="#000080">),(</font>MilieuX<font color="#000080">+</font>a<font color="#000080">),</font>Y1<font color="#000080">,</font>Y2<font color="#000080">,</font>FG<font color="#000080">,</font>BG<font color="#000080">);
     </font>delay <font color="#000080">(</font>Delai<font color="#000080">);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

   </font><font color="#FF0000"><b>if </b></font>Gauche <font color="#000080">&lt;&gt; </font>Droite <font color="#FF0000"><b>then </b></font>Cadre <font color="#000080">(</font>X1<font color="#000080">,</font>X2<font color="#000080">,</font>Y1<font color="#000080">,</font>Y2<font color="#000080">,</font>FG<font color="#000080">,</font>BG<font color="#000080">);

   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;


</font><font color="#FF0000"><b>Procedure </b></font>Scroll <font color="#000080">(</font>x1<font color="#000080">,</font>x2<font color="#000080">,</font>Y<font color="#000080">:</font>Byte<font color="#000080">;</font>S<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">;</font>fg<font color="#000080">,</font>bg<font color="#000080">,</font>vitesse<font color="#000080">:</font>integer<font color="#000080">);

</font><font color="#008000"><i>{ Avec
      x1 et x2 position x de la fenŠtre de scrolling
      Y        position Y de la fenŠtre de scrolling
      S        Chaine de caractŠres … faire d‚filer
      fg       ForeGround (Couleur du Texte)
      bg       BackGround (Couleur du Fond)
      vitesse  Vitesse du scrolling


 Tout appui sur une touche arrete le scrolling et vide le buffer clavier

}

 </i></font><font color="#FF0000"><b>Var
    </b></font>a<font color="#000080">,</font>b<font color="#000080">,</font>LonFenetre<font color="#000080">,</font>LonStr<font color="#000080">: </font>Byte<font color="#000080">;
    </font>ch<font color="#000080">,</font>dh<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;

 </font><font color="#FF0000"><b>Begin

  </b></font>Ch<font color="#000080">:=</font><font color="#800000">''</font><font color="#000080">;
  </font>LonFenetre<font color="#000080">:=(</font>x2<font color="#000080">-</font>x1<font color="#000080">);
  </font>LonStr<font color="#000080">:=</font>Length<font color="#000080">(</font>S<font color="#000080">);

  </font><font color="#FF0000"><b>For </b></font>b<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#000080">(</font>LonFenetre<font color="#000080">) </font><font color="#FF0000"><b>do </b></font>ch<font color="#000080">:=</font>concat <font color="#000080">(</font>ch<font color="#000080">,</font><font color="#800000">' '</font><font color="#000080">);  </font><font color="#008000"><i>{ Rajoute N epaces avant
et apres la chaine S}  </i></font>dh<font color="#000080">:=</font>ch<font color="#000080">;
  </font>ch<font color="#000080">:= </font>concat<font color="#000080">(</font>ch<font color="#000080">,</font>S<font color="#000080">,</font>ch<font color="#000080">);
  </font>b<font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;

  </font><font color="#FF0000"><b>Repeat
   Begin
    </b></font>b<font color="#000080">:=</font>b<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">;
    </font>Ecris<font color="#000080">(</font>x1<font color="#000080">,</font>Y<font color="#000080">,</font>Copy<font color="#000080">(</font>ch<font color="#000080">,</font>b<font color="#000080">,</font>LonFenetre<font color="#000080">),</font>fg<font color="#000080">,</font>bg<font color="#000080">);
    </font>delay<font color="#000080">(</font>Vitesse<font color="#000080">);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>Until </b></font><font color="#000080">(</font>Keypressed<font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>b<font color="#000080">&gt;(</font>LonFenetre<font color="#000080">+</font>LonStr<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">));
  </font>Vide_Buffer_Clavier<font color="#000080">;
  </font>Ecris<font color="#000080">(</font>x1<font color="#000080">,</font>Y<font color="#000080">,</font>dh<font color="#000080">,</font>fg<font color="#000080">,</font>bg<font color="#000080">);
 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>Scroll_Inverse <font color="#000080">(</font>x1<font color="#000080">,</font>x2<font color="#000080">,</font>Y<font color="#000080">:</font>Byte<font color="#000080">;</font>S<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">;</font>fg<font color="#000080">,</font>bg<font color="#000080">,</font>vitesse<font color="#000080">:</font>integer<font color="#000080">);

 </font><font color="#FF0000"><b>Var
    </b></font>a<font color="#000080">,</font>b<font color="#000080">,</font>LonFenetre<font color="#000080">,</font>LonStr<font color="#000080">: </font>Byte<font color="#000080">;
    </font>ch<font color="#000080">,</font>dh<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;

 </font><font color="#FF0000"><b>Begin

  </b></font>Ch<font color="#000080">:=</font><font color="#800000">''</font><font color="#000080">;
  </font>LonFenetre<font color="#000080">:=(</font>x2<font color="#000080">-</font>x1<font color="#000080">);
  </font>LonStr<font color="#000080">:=</font>Length<font color="#000080">(</font>S<font color="#000080">);

  </font><font color="#FF0000"><b>For </b></font>b<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#000080">(</font>LonFenetre<font color="#000080">) </font><font color="#FF0000"><b>do </b></font>ch<font color="#000080">:=</font>concat <font color="#000080">(</font>ch<font color="#000080">,</font><font color="#800000">' '</font><font color="#000080">);  </font><font color="#008000"><i>{ Rajoute N epaces avant
et apres la chaine S}  </i></font>dh<font color="#000080">:=</font>ch<font color="#000080">;
  </font>ch<font color="#000080">:= </font>concat<font color="#000080">(</font>ch<font color="#000080">,</font>S<font color="#000080">,</font>ch<font color="#000080">);
  </font>b<font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;

  </font><font color="#FF0000"><b>Repeat
   Begin
    </b></font>b<font color="#000080">:=</font>b<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">;
    </font>Ecris<font color="#000080">(</font>x1<font color="#000080">,</font>Y<font color="#000080">,</font>Copy<font color="#000080">(</font>ch<font color="#000080">,(</font>LonFenetre<font color="#000080">+</font>LonStr<font color="#000080">)-</font>b<font color="#000080">,</font>LonFenetre<font color="#000080">),</font>fg<font color="#000080">,</font>bg<font color="#000080">);
    </font>delay<font color="#000080">(</font>Vitesse<font color="#000080">);

   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>Until </b></font><font color="#000080">(</font>Keypressed<font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>b<font color="#000080">&gt;(</font>LonFenetre<font color="#000080">+</font>LonStr<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">));
  </font>Vide_Buffer_Clavier<font color="#000080">;
  </font>Ecris<font color="#000080">(</font>x1<font color="#000080">,</font>Y<font color="#000080">,</font>dh<font color="#000080">,</font>fg<font color="#000080">,</font>bg<font color="#000080">);
 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>Scroll_No_Exit <font color="#000080">(</font>x1<font color="#000080">,</font>x2<font color="#000080">,</font>Y<font color="#000080">:</font>Byte<font color="#000080">;</font>S<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">;</font>fg<font color="#000080">,</font>bg<font color="#000080">,</font>vitesse<font color="#000080">:</font>integer<font color="#000080">);

</font><font color="#008000"><i>{ Proc‚dure identique … Scroll mais sans possibilit‚ d'Echap.}

 </i></font><font color="#FF0000"><b>Var
    </b></font>a<font color="#000080">,</font>b<font color="#000080">,</font>LonFenetre<font color="#000080">,</font>LonStr<font color="#000080">: </font>Byte<font color="#000080">;
    </font>ch<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;

 </font><font color="#FF0000"><b>Begin

  </b></font>Ch<font color="#000080">:=</font><font color="#800000">''</font><font color="#000080">;
  </font>LonFenetre<font color="#000080">:=(</font>x2<font color="#000080">-</font>x1<font color="#000080">);
  </font>LonStr<font color="#000080">:=</font>Length<font color="#000080">(</font>S<font color="#000080">);

  </font><font color="#FF0000"><b>For </b></font>b<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#000080">(</font>LonFenetre<font color="#000080">) </font><font color="#FF0000"><b>do </b></font>ch<font color="#000080">:=</font>concat <font color="#000080">(</font>ch<font color="#000080">,</font><font color="#800000">' '</font><font color="#000080">);  </font><font color="#008000"><i>{ Rajoute N epaces avant
et apres la chaine S}  </i></font>ch<font color="#000080">:= </font>concat<font color="#000080">(</font>ch<font color="#000080">,</font>S<font color="#000080">,</font>ch<font color="#000080">);
  </font>b<font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;

  </font><font color="#FF0000"><b>Repeat
   Begin
    </b></font>b<font color="#000080">:=</font>b<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">;
    </font>Ecris<font color="#000080">(</font>x1<font color="#000080">,</font>Y<font color="#000080">,</font>Copy<font color="#000080">(</font>ch<font color="#000080">,</font>b<font color="#000080">,</font>LonFenetre<font color="#000080">),</font>fg<font color="#000080">,</font>bg<font color="#000080">);
    </font>delay<font color="#000080">(</font>Vitesse<font color="#000080">);

   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>Until </b></font><font color="#000080">(</font>b<font color="#000080">&gt;(</font>LonFenetre<font color="#000080">+</font>LonStr<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">));
  </font>Vide_Buffer_Clavier<font color="#000080">;

 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>Scroll_Inverse_No_Exit
<font color="#000080">(</font>x1<font color="#000080">,</font>x2<font color="#000080">,</font>Y<font color="#000080">:</font>Byte<font color="#000080">;</font>S<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">;</font>fg<font color="#000080">,</font>bg<font color="#000080">,</font>vitesse<font color="#000080">:</font>integer<font color="#000080">);
</font><font color="#008000"><i>{ Proc‚dure identique … Scroll mais sans possibilit‚ d'Echap.}

 </i></font><font color="#FF0000"><b>Var
    </b></font>a<font color="#000080">,</font>b<font color="#000080">,</font>LonFenetre<font color="#000080">,</font>LonStr<font color="#000080">: </font>Byte<font color="#000080">;
    </font>ch<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;

 </font><font color="#FF0000"><b>Begin

  </b></font>Ch<font color="#000080">:=</font><font color="#800000">''</font><font color="#000080">;
  </font>LonFenetre<font color="#000080">:=(</font>x2<font color="#000080">-</font>x1<font color="#000080">);
  </font>LonStr<font color="#000080">:=</font>Length<font color="#000080">(</font>S<font color="#000080">);

  </font><font color="#FF0000"><b>For </b></font>b<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#000080">(</font>LonFenetre<font color="#000080">) </font><font color="#FF0000"><b>do </b></font>ch<font color="#000080">:=</font>concat <font color="#000080">(</font>ch<font color="#000080">,</font><font color="#800000">' '</font><font color="#000080">);  </font><font color="#008000"><i>{ Rajoute N epaces avant
et apres la chaine S}
  </i></font>ch<font color="#000080">:= </font>concat<font color="#000080">(</font>ch<font color="#000080">,</font>S<font color="#000080">,</font>ch<font color="#000080">);
  </font>b<font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;

  </font><font color="#FF0000"><b>Repeat
   Begin
    </b></font>b<font color="#000080">:=</font>b<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">;
    </font>Ecris<font color="#000080">(</font>x1<font color="#000080">,</font>Y<font color="#000080">,</font>Copy<font color="#000080">(</font>ch<font color="#000080">,(</font>LonFenetre<font color="#000080">+</font>LonStr<font color="#000080">)-</font>b<font color="#000080">,</font>LonFenetre<font color="#000080">),</font>fg<font color="#000080">,</font>bg<font color="#000080">);
    </font>delay<font color="#000080">(</font>Vitesse<font color="#000080">);

   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>Until </b></font><font color="#000080">(</font>b<font color="#000080">&gt;(</font>LonFenetre<font color="#000080">+</font>LonStr<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">));
  </font>Vide_Buffer_Clavier<font color="#000080">;

 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to TEXTWNDW SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0022.PAS">Original</a><b>]</b></p></body>
</html>
