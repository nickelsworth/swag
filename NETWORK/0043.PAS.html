<html>
<head><title> "Netware 3.11 API Library - NetStat" by S.PEREVOZNIK</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to NETWORK SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0043.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#008000"><i>{
            &Eacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&raquo;
            &ordm;     &Uacute;&Euml;&Iacute;&Iacute;&Iacute;&Euml;&iquest;&Uacute;&Euml;&Iacute;&Iacute;&Iacute;&Euml;&iquest;&Uacute;&Euml;&Iacute;&Iacute;&Iacute;&Euml;&iquest;&Uacute;&Euml;&Iacute;&raquo; &Euml;&iquest;&Uacute;&Euml;&Iacute;&Iacute;&Iacute;&Euml;&iquest;&Uacute;&Eacute;&Iacute;&Euml;&Iacute;&raquo;&iquest;   &ordm;
            &ordm;     &sup3;&Igrave;&Iacute;&Iacute;&Iacute;&Ecirc;&Ugrave;&Atilde;&Icirc;&Iacute;&Iacute;&Iacute;&Icirc;&acute;&Agrave;&Ecirc;&Iacute;&Iacute;&Iacute;&Euml;&iquest;&sup3;&ordm; &ordm; &ordm;&sup3;&Atilde;&Icirc;&Iacute;&Iacute;      &ordm;      &ordm;
            &ordm;     &Agrave;&Ecirc;     &Agrave;&Ecirc;   &Ecirc;&Ugrave;&Agrave;&Ecirc;&Iacute;&Iacute;&Iacute;&Ecirc;&Ugrave;&Agrave;&Ecirc; &Egrave;&Iacute;&Ecirc;&Ugrave;&Agrave;&Ecirc;&Iacute;&Iacute;&Iacute;&Ecirc;&Ugrave;   &Ecirc;      &ordm;
            &ordm;                                                  &ordm;
            &ordm;     NetWare 3.11 API Library for Turbo Pascal    &ordm;
            &ordm;                      by                          &ordm;
            &ordm;                 S.Perevoznik                     &ordm;
            &ordm;                     1996                         &ordm;
            &Egrave;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&frac14;
}

</i></font><font color="#FF0000"><b>Unit </b></font>NetStat<font color="#000080">;

</font><font color="#FF0000"><b>Interface

Uses </b></font>NetConv<font color="#000080">;

</font><font color="#FF0000"><b>Type </b></font>PhysDiskStats <font color="#000080">= </font><font color="#FF0000"><b>record
      </b></font>SystemElapsedTime <font color="#000080">: </font>LongInt<font color="#000080">;
      </font>DiskChanell<font color="#000080">,
      </font>Diskremovable<font color="#000080">,
      </font>DriveType<font color="#000080">,
      </font>ControllerDriveNumber<font color="#000080">,
      </font>ControllerNumber<font color="#000080">,
      </font>ControllerType    <font color="#000080">: </font>byte<font color="#000080">;
      </font>DriveSize         <font color="#000080">: </font>longInt<font color="#000080">; </font><font color="#008000"><i>{ in 4096 byte blocks}
      </i></font>DriveCylinders    <font color="#000080">: </font>word<font color="#000080">;
      </font>DriveHeads<font color="#000080">,
      </font>SectorsPerTrack   <font color="#000080">: </font>byte<font color="#000080">;
      </font>DriveDefinition   <font color="#000080">: </font><font color="#FF0000"><b>array </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">63</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>char<font color="#000080">;
      </font>IOErrorCount      <font color="#000080">: </font>word<font color="#000080">;
      </font>HotFixStart       <font color="#000080">: </font>LongInt<font color="#000080">;
      </font>HotFixSize <font color="#000080">,
      </font>HotFixBlockAvailable <font color="#000080">: </font>word<font color="#000080">;
      </font>HotFixDisabled    <font color="#000080">: </font>byte<font color="#000080">;
     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

     </font>FileStats <font color="#000080">= </font><font color="#FF0000"><b>record
      </b></font>SystemElapsedTime      <font color="#000080">: </font>LongInt<font color="#000080">;
      </font>MaxOpenFiles           <font color="#000080">: </font>Word<font color="#000080">;
      </font>MaxFilesOpened         <font color="#000080">: </font>Word<font color="#000080">;
      </font>CurrOpenFiles          <font color="#000080">: </font>Word<font color="#000080">;
      </font>TotalFilesOpened       <font color="#000080">: </font>LongInt<font color="#000080">;
      </font>TotalReadRequests      <font color="#000080">: </font>LongInt<font color="#000080">;
      </font>TotalWriteRequests     <font color="#000080">: </font>LongInt<font color="#000080">;
      </font>CurrChangedFATSectors  <font color="#000080">: </font>Word<font color="#000080">;
      </font>TotalChangedFATSectors <font color="#000080">: </font>LongInt<font color="#000080">;
      </font>FATWriteErrors         <font color="#000080">: </font>Word<font color="#000080">;
      </font>FatalFATWriteErrors    <font color="#000080">: </font>Word<font color="#000080">;
      </font>FATScanErrors          <font color="#000080">: </font>Word<font color="#000080">;
      </font>MaxIndexFilesOpened    <font color="#000080">: </font>Word<font color="#000080">;
      </font>CurrOpenIndexedFiles   <font color="#000080">: </font>Word<font color="#000080">;
      </font>AttachedIndexFiles     <font color="#000080">: </font>Word<font color="#000080">;
      </font>AvailableIndexFiles    <font color="#000080">: </font>Word<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;


      </font>CacheStats <font color="#000080">= </font><font color="#FF0000"><b>record
            </b></font>systemElapsedTime        <font color="#000080">: </font>LongInt <font color="#000080">;
            </font>cacheBufferCount         <font color="#000080">: </font>Word <font color="#000080">;
            </font>cacheBufferSize          <font color="#000080">: </font>Word <font color="#000080">;
            </font>dirtyCacheBuffers        <font color="#000080">: </font>Word <font color="#000080">;
            </font>cacheReadRequests        <font color="#000080">: </font>LongInt <font color="#000080">;
            </font>cacheWriteRequests       <font color="#000080">: </font>LongInt <font color="#000080">;
            </font>cacheHits                <font color="#000080">: </font>LongInt <font color="#000080">;
            </font>cacheMisses              <font color="#000080">: </font>LongInt <font color="#000080">;
            </font>physicalReadRequests     <font color="#000080">: </font>LongInt <font color="#000080">;
            </font>physicalWriteRequests    <font color="#000080">: </font>LongInt <font color="#000080">;
            </font>physicalReadErrors       <font color="#000080">: </font>WORD <font color="#000080">;
            </font>physicalWriteErrors      <font color="#000080">: </font>WORD <font color="#000080">;
            </font>cacheGetRequests         <font color="#000080">: </font>LongInt <font color="#000080">;
            </font>cacheFullWriteRequests   <font color="#000080">: </font>LongInt <font color="#000080">;
            </font>cachePartialWriteRequests<font color="#000080">: </font>LongInt <font color="#000080">;
            </font>backgroundDirtyWrites    <font color="#000080">: </font>LongInt <font color="#000080">;
            </font>backgroundAgedWrites     <font color="#000080">: </font>LongInt <font color="#000080">;
            </font>totalCacheWrites         <font color="#000080">: </font>LongInt <font color="#000080">;
            </font>cacheAllocations         <font color="#000080">: </font>LongInt <font color="#000080">;
            </font>thrashingCount           <font color="#000080">: </font>WORD <font color="#000080">;
            </font>LRUBlockWasDirtyCount    <font color="#000080">: </font>WORD <font color="#000080">;
            </font>readBeyondWriteCount     <font color="#000080">: </font>WORD <font color="#000080">;
            </font>fragmentedWriteCount     <font color="#000080">: </font>WORD <font color="#000080">;
            </font>cacheHitOnUnavailCount   <font color="#000080">: </font>WORD <font color="#000080">;
            </font>cacheBlockScrappedCount  <font color="#000080">: </font>WORD <font color="#000080">;
           </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

    </font>ServerLANIO <font color="#000080">= </font><font color="#FF0000"><b>record
             </b></font>systemElapsedTime              <font color="#000080">: </font>LongInt <font color="#000080">;
             </font>maxRoutingBuffersAvail         <font color="#000080">: </font>Word    <font color="#000080">;
             </font>maxRoutingBuffersUsed          <font color="#000080">: </font>Word    <font color="#000080">;
             </font>routingBuffersInUse            <font color="#000080">: </font>Word    <font color="#000080">;
             </font>totalFileServicePackets        <font color="#000080">: </font>LongInt <font color="#000080">;
             </font>fileServicePacketsBuffered     <font color="#000080">: </font>Word    <font color="#000080">;
             </font>invalidConnPacketCount         <font color="#000080">: </font>Word    <font color="#000080">;
             </font>badLogicalConnCount            <font color="#000080">: </font>Word    <font color="#000080">;
             </font>packetsRcvdDuringProcCount     <font color="#000080">: </font>Word    <font color="#000080">;
             </font>reprocessedRequestCount        <font color="#000080">: </font>Word    <font color="#000080">;
             </font>badSequenceNumberPacketCount   <font color="#000080">: </font>Word    <font color="#000080">;
             </font>duplicateReplyCount            <font color="#000080">: </font>Word    <font color="#000080">;
             </font>acknowledgementsSent           <font color="#000080">: </font>Word    <font color="#000080">;
             </font>badRequestTypeCount            <font color="#000080">: </font>Word    <font color="#000080">;
             </font>attachDuringProcCount          <font color="#000080">: </font>Word    <font color="#000080">;
             </font>attachWhileAttachingCount      <font color="#000080">: </font>Word    <font color="#000080">;
             </font>forgedDetachRequestCount       <font color="#000080">: </font>Word    <font color="#000080">;
             </font>badConnNumberOnDetachCount     <font color="#000080">: </font>Word    <font color="#000080">;
             </font>detachDuringProcCount          <font color="#000080">: </font>Word    <font color="#000080">;
             </font>repliesCanceledCount           <font color="#000080">: </font>Word    <font color="#000080">;
             </font>hopCountDiscardCount           <font color="#000080">: </font>Word    <font color="#000080">;
             </font>unknownNetDiscardCount         <font color="#000080">: </font>Word    <font color="#000080">;
             </font>noDGroupBufferDiscardCount     <font color="#000080">: </font>Word    <font color="#000080">;
             </font>outPacketNoBufferDiscardCount  <font color="#000080">: </font>Word    <font color="#000080">;
             </font>IPXNotMyNetworkCount           <font color="#000080">: </font>Word    <font color="#000080">;
             </font>NetBIOSPropagationCount        <font color="#000080">: </font>LongInt <font color="#000080">;
             </font>totalOtherPackets              <font color="#000080">: </font>LongInt <font color="#000080">;
             </font>totalRoutedPackets             <font color="#000080">: </font>LongInt <font color="#000080">;
          </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

       </font>ServerMiscInfo <font color="#000080">= </font><font color="#FF0000"><b>record
             </b></font>systemElapsedTime        <font color="#000080">: </font>LongInt<font color="#000080">;
             </font>processorType            <font color="#000080">: </font>BYTE<font color="#000080">;
             </font>reserved                 <font color="#000080">: </font>BYTE<font color="#000080">;
             </font>serviceProcessCount      <font color="#000080">: </font>BYTE<font color="#000080">;
             </font>serverUtilizationPercent <font color="#000080">: </font>BYTE<font color="#000080">;
             </font>maxBinderyObjectsAvail   <font color="#000080">: </font>WORD<font color="#000080">;
             </font>maxBinderyObjectsUsed    <font color="#000080">: </font>WORD<font color="#000080">;
             </font>binderyObjectsInUse      <font color="#000080">: </font>WORD<font color="#000080">;
             </font>serverMemoryInK          <font color="#000080">: </font>Word <font color="#000080">;
             </font>serverWastedMemoryInK    <font color="#000080">: </font>Word <font color="#000080">;
             </font>dynamicAreaCount         <font color="#000080">: </font>Word <font color="#000080">;
             </font>dynamicSpace1            <font color="#000080">: </font>LongInt<font color="#000080">;
             </font>maxUsedDynamicSpace1     <font color="#000080">: </font>LongInt<font color="#000080">;
             </font>dynamicSpaceInUse1       <font color="#000080">: </font>LongInt<font color="#000080">;
             </font>dynamicSpace2            <font color="#000080">: </font>LongInt<font color="#000080">;
             </font>maxUsedDynamicSpace2     <font color="#000080">: </font>LongInt<font color="#000080">;
             </font>dynamicSpaceInUse2       <font color="#000080">: </font>LongInt<font color="#000080">;
             </font>dynamicSpace3            <font color="#000080">: </font>LongInt<font color="#000080">;
             </font>maxUsedDynamicSpace3     <font color="#000080">: </font>LongInt<font color="#000080">;
             </font>dynamicSpaceInUse3       <font color="#000080">: </font>LongInt<font color="#000080">;
          </font><font color="#FF0000"><b>end</b></font><font color="#000080">;




</font><font color="#FF0000"><b>Function </b></font>GetPhysicalDiskStats<font color="#000080">(</font>PhysicalDiskNumber <font color="#000080">: </font>byte<font color="#000080">;
                              </font><font color="#FF0000"><b>Var </b></font>PhysicalDiskStats <font color="#000080">: </font>PhysDiskStats<font color="#000080">) : </font>byte<font color="#000080">;


</font><font color="#FF0000"><b>Function </b></font>GetFileSystemStats<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>FileSystemStats <font color="#000080">: </font>FileStats <font color="#000080">) : </font>byte<font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>GetDiskCacheStats<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>DiskCacheStats <font color="#000080">: </font>CacheStats <font color="#000080">) : </font>byte<font color="#000080">;


</font><font color="#FF0000"><b>Function </b></font>GetServerLANIOStats<font color="#000080">( </font><font color="#FF0000"><b>Var </b></font>ServerLANIOStats <font color="#000080">: </font>ServerLANIO <font color="#000080">) : </font>byte<font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>GetServerMiscInformation<font color="#000080">( </font><font color="#FF0000"><b>Var </b></font>ServerMiscInformation <font color="#000080">: </font>ServerMiscInfo<font color="#000080">) : </font>byte<font color="#000080">;


</font><font color="#008000"><i>{________________________ GetDiskUtilization _____________________________
|
| Output:   0		       --  SUCCESSFUL
|	    network error code --  UNSUCCESSFUL
|
| Comments:
|   This function returns the disk usage of a bindery object on a volume.
|   To determine the total disk space used, this call should be made
|   repetitively for all mounted volumes.  To determine the number of bytes
|   of disk space used, the usedBlocks should be multiplied by the number of
|   sectors and the bytes per sector. Currently network implementations
|   allocate the disk in 8 512-byte sectors per block, which is 4K per block.
|__________________________________________________________________________}


</i></font><font color="#FF0000"><b>Function </b></font>GetDiskUtilization<font color="#000080">( </font>VolumeNumber <font color="#000080">: </font>byte<font color="#000080">;
                             </font>ObjectID     <font color="#000080">: </font>LongInt<font color="#000080">;
                             </font><font color="#FF0000"><b>Var </b></font>UsedDirectories <font color="#000080">: </font>Word<font color="#000080">;
                             </font><font color="#FF0000"><b>Var </b></font>UsedFiles       <font color="#000080">: </font>Word<font color="#000080">;
                             </font><font color="#FF0000"><b>Var </b></font>UsedBlocks      <font color="#000080">: </font>Word<font color="#000080">) : </font>byte<font color="#000080">;



</font><font color="#FF0000"><b>Implementation

Uses </b></font>Dos<font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>GetPhysicalDiskStats<font color="#000080">(</font>PhysicalDiskNumber <font color="#000080">: </font>byte<font color="#000080">;
                              </font><font color="#FF0000"><b>Var </b></font>PhysicalDiskStats <font color="#000080">: </font>PhysDiskStats<font color="#000080">) : </font>byte<font color="#000080">;

</font><font color="#FF0000"><b>Var
  </b></font>r <font color="#000080">: </font>registers<font color="#000080">;
  </font>SendPacket  <font color="#000080">:  </font><font color="#FF0000"><b>array </b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">004</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>byte<font color="#000080">;
  </font>ReplyPacket <font color="#000080">:  </font><font color="#FF0000"><b>array </b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">096</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>byte<font color="#000080">;
  </font>WordPtr     <font color="#000080">: ^</font>Word<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>SendPacket<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">] := </font><font color="#800000">$D8</font><font color="#000080">;
  </font>SendPacket<font color="#000080">[</font><font color="#800000">3</font><font color="#000080">] := </font>PhysicalDiskNumber<font color="#000080">;
  </font>WordPtr <font color="#000080">:= </font>addr<font color="#000080">(</font>SendPacket<font color="#000080">);
  </font>WordPtr<font color="#000080">^ := </font><font color="#800000">2</font><font color="#000080">;
  </font>WordPtr  <font color="#000080">:= </font>addr<font color="#000080">(</font>ReplyPacket<font color="#000080">);
  </font>WordPtr<font color="#000080">^ := </font><font color="#800000">94</font><font color="#000080">;

  </font>r<font color="#000080">.</font>BX <font color="#000080">:= </font>r<font color="#000080">.</font>DS<font color="#000080">;
  </font>r<font color="#000080">.</font>AH <font color="#000080">:= </font><font color="#800000">$0E3</font><font color="#000080">;
  </font>r<font color="#000080">.</font>DS <font color="#000080">:= </font>SEG<font color="#000080">(</font>SendPacket<font color="#000080">);
  </font>r<font color="#000080">.</font>SI <font color="#000080">:= </font>OFS<font color="#000080">(</font>SendPacket<font color="#000080">);
  </font>r<font color="#000080">.</font>ES <font color="#000080">:= </font>SEG<font color="#000080">(</font>ReplyPacket<font color="#000080">);
  </font>r<font color="#000080">.</font>DI <font color="#000080">:= </font>OFS<font color="#000080">(</font>ReplyPacket<font color="#000080">);
  </font>intr<font color="#000080">(</font><font color="#800000">$21</font><font color="#000080">,</font>r<font color="#000080">);
  </font>r<font color="#000080">.</font>DS <font color="#000080">:= </font>r<font color="#000080">.</font>BX<font color="#000080">;
  </font>GetPhysicaldiskStats <font color="#000080">:= </font>r<font color="#000080">.</font>AL<font color="#000080">;
  </font><font color="#FF0000"><b>if </b></font>r<font color="#000080">.</font>AL <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>then
    begin
      </b></font>move<font color="#000080">(</font>ReplyPacket<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">],</font>PhysicalDiskStats<font color="#000080">,</font><font color="#800000">94</font><font color="#000080">);
      </font><font color="#FF0000"><b>with </b></font>PhysicalDiskStats <font color="#FF0000"><b>do
        begin
          </b></font>SystemElapsedTime <font color="#000080">:= </font>GetLong<font color="#000080">(</font>Addr<font color="#000080">(</font>SystemElapsedTime<font color="#000080">));
          </font>DriveSize <font color="#000080">:= </font>GetLong<font color="#000080">(</font>Addr<font color="#000080">(</font>DriveSize<font color="#000080">));
          </font>DriveCylinders <font color="#000080">:= </font>GetWord<font color="#000080">(</font>Addr<font color="#000080">(</font>DriveCylinders<font color="#000080">));
          </font>IOErrorCount   <font color="#000080">:= </font>GetWord<font color="#000080">(</font>Addr<font color="#000080">(</font>IOErrorCount<font color="#000080">));
          </font>HotFixStart    <font color="#000080">:= </font>GetLong<font color="#000080">(</font>Addr<font color="#000080">(</font>HotFixStart<font color="#000080">));
          </font>HotFixSize     <font color="#000080">:= </font>GetWord<font color="#000080">(</font>Addr<font color="#000080">(</font>HotFixSize<font color="#000080">));
          </font>HotFixBlockAvailable <font color="#000080">:= </font>GetWord<font color="#000080">(</font>Addr<font color="#000080">(</font>HotFixBlockAvailable<font color="#000080">));
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>GetFileSystemStats<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>FileSystemStats <font color="#000080">: </font>FileStats <font color="#000080">) : </font>byte<font color="#000080">;
</font><font color="#FF0000"><b>Var
  </b></font>r <font color="#000080">: </font>registers<font color="#000080">;
  </font>SendPacket  <font color="#000080">:  </font><font color="#FF0000"><b>array </b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">003</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>byte<font color="#000080">;
  </font>ReplyPacket <font color="#000080">:  </font><font color="#FF0000"><b>array </b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">030</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>byte<font color="#000080">;
  </font>WordPtr     <font color="#000080">: ^</font>Word<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>SendPacket<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">] := </font><font color="#800000">$D4</font><font color="#000080">;
  </font>WordPtr <font color="#000080">:= </font>addr<font color="#000080">(</font>SendPacket<font color="#000080">);
  </font>WordPtr<font color="#000080">^ := </font><font color="#800000">1</font><font color="#000080">;
  </font>WordPtr  <font color="#000080">:= </font>addr<font color="#000080">(</font>ReplyPacket<font color="#000080">);
  </font>WordPtr<font color="#000080">^ := </font><font color="#800000">28</font><font color="#000080">;

  </font>r<font color="#000080">.</font>BX <font color="#000080">:= </font>r<font color="#000080">.</font>DS<font color="#000080">;
  </font>r<font color="#000080">.</font>AH <font color="#000080">:= </font><font color="#800000">$0E3</font><font color="#000080">;
  </font>r<font color="#000080">.</font>DS <font color="#000080">:= </font>SEG<font color="#000080">(</font>SendPacket<font color="#000080">);
  </font>r<font color="#000080">.</font>SI <font color="#000080">:= </font>OFS<font color="#000080">(</font>SendPacket<font color="#000080">);
  </font>r<font color="#000080">.</font>ES <font color="#000080">:= </font>SEG<font color="#000080">(</font>ReplyPacket<font color="#000080">);
  </font>r<font color="#000080">.</font>DI <font color="#000080">:= </font>OFS<font color="#000080">(</font>ReplyPacket<font color="#000080">);
  </font>intr<font color="#000080">(</font><font color="#800000">$21</font><font color="#000080">,</font>r<font color="#000080">);
  </font>r<font color="#000080">.</font>DS <font color="#000080">:= </font>r<font color="#000080">.</font>BX<font color="#000080">;
  </font>GetFileSystemStats <font color="#000080">:= </font>r<font color="#000080">.</font>AL<font color="#000080">;
  </font><font color="#FF0000"><b>if </b></font>r<font color="#000080">.</font>AL <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>then
    begin
      </b></font>move<font color="#000080">(</font>ReplyPacket<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">],</font>FileSystemStats<font color="#000080">,</font><font color="#800000">28</font><font color="#000080">);
      </font><font color="#FF0000"><b>with </b></font>FileSystemStats <font color="#FF0000"><b>do
        begin
          </b></font>SystemElapsedTime <font color="#000080">:= </font>GetLong<font color="#000080">(</font>Addr<font color="#000080">(</font>SystemElapsedTime<font color="#000080">));

          </font>MaxOpenFiles      <font color="#000080">:= </font>GetWord<font color="#000080">(</font>Addr<font color="#000080">(</font>MaxOpenFiles<font color="#000080">));
          </font>MaxFilesOpened    <font color="#000080">:= </font>GetWord<font color="#000080">(</font>Addr<font color="#000080">(</font>MaxFilesOpened<font color="#000080">));
          </font>CurrOpenFiles     <font color="#000080">:= </font>GetWord<font color="#000080">(</font>Addr<font color="#000080">(</font>CurrOpenFiles<font color="#000080">));

          </font>TotalFilesOpened  <font color="#000080">:= </font>GetLong<font color="#000080">(</font>Addr<font color="#000080">(</font>TotalFilesOpened<font color="#000080">));
          </font>TotalReadRequests <font color="#000080">:= </font>GetLong<font color="#000080">(</font>Addr<font color="#000080">(</font>TotalReadRequests<font color="#000080">));
          </font>TotalWriteRequests<font color="#000080">:= </font>GetLong<font color="#000080">(</font>Addr<font color="#000080">(</font>TotalWriteRequests<font color="#000080">));

          </font>CurrChangedFATSectors  <font color="#000080">:= </font>GetWord<font color="#000080">(</font>Addr<font color="#000080">(</font>CurrChangedFATSectors<font color="#000080">));
          </font>TotalChangedFATSectors <font color="#000080">:= </font>GetLong<font color="#000080">(</font>Addr<font color="#000080">(</font>TotalChangedFATSectors<font color="#000080">));
          </font>FATWriteErrors         <font color="#000080">:= </font>GetWord<font color="#000080">(</font>Addr<font color="#000080">(</font>FATWriteErrors<font color="#000080">));
          </font>FatalFATWriteErrors    <font color="#000080">:= </font>GetWord<font color="#000080">(</font>Addr<font color="#000080">(</font>FatalFATWriteErrors<font color="#000080">));
          </font>FATScanErrors          <font color="#000080">:= </font>GetWord<font color="#000080">(</font>Addr<font color="#000080">(</font>FATScanErrors<font color="#000080">));
          </font>MaxIndexFilesOpened    <font color="#000080">:= </font>GetWord<font color="#000080">(</font>Addr<font color="#000080">(</font>MaxIndexFilesOpened<font color="#000080">));
          </font>CurrOpenIndexedFiles   <font color="#000080">:= </font>GetWord<font color="#000080">(</font>Addr<font color="#000080">(</font>CurrOpenIndexedFiles<font color="#000080">));
          </font>AttachedIndexFiles     <font color="#000080">:= </font>GetWord<font color="#000080">(</font>Addr<font color="#000080">(</font>AttachedIndexFiles<font color="#000080">));
          </font>AvailableIndexFiles    <font color="#000080">:= </font>GetWord<font color="#000080">(</font>Addr<font color="#000080">(</font>AvailableIndexFiles<font color="#000080">));
         </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
       </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>GetDiskCacheStats<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>DiskCacheStats <font color="#000080">: </font>CacheStats <font color="#000080">) : </font>byte<font color="#000080">;
</font><font color="#FF0000"><b>Var
  </b></font>r <font color="#000080">: </font>registers<font color="#000080">;
  </font>SendPacket  <font color="#000080">:  </font><font color="#FF0000"><b>array </b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">003</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>byte<font color="#000080">;
  </font>ReplyPacket <font color="#000080">:  </font><font color="#FF0000"><b>array </b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">080</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>byte<font color="#000080">;
  </font>WordPtr     <font color="#000080">: ^</font>Word<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>SendPacket<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">] := </font><font color="#800000">$D6</font><font color="#000080">;
  </font>WordPtr <font color="#000080">:= </font>addr<font color="#000080">(</font>SendPacket<font color="#000080">);
  </font>WordPtr<font color="#000080">^ := </font><font color="#800000">1</font><font color="#000080">;
  </font>WordPtr  <font color="#000080">:= </font>addr<font color="#000080">(</font>ReplyPacket<font color="#000080">);
  </font>WordPtr<font color="#000080">^ := </font><font color="#800000">78</font><font color="#000080">;

  </font>r<font color="#000080">.</font>BX <font color="#000080">:= </font>r<font color="#000080">.</font>DS<font color="#000080">;
  </font>r<font color="#000080">.</font>AH <font color="#000080">:= </font><font color="#800000">$0E3</font><font color="#000080">;
  </font>r<font color="#000080">.</font>DS <font color="#000080">:= </font>SEG<font color="#000080">(</font>SendPacket<font color="#000080">);
  </font>r<font color="#000080">.</font>SI <font color="#000080">:= </font>OFS<font color="#000080">(</font>SendPacket<font color="#000080">);
  </font>r<font color="#000080">.</font>ES <font color="#000080">:= </font>SEG<font color="#000080">(</font>ReplyPacket<font color="#000080">);
  </font>r<font color="#000080">.</font>DI <font color="#000080">:= </font>OFS<font color="#000080">(</font>ReplyPacket<font color="#000080">);
  </font>intr<font color="#000080">(</font><font color="#800000">$21</font><font color="#000080">,</font>r<font color="#000080">);
  </font>r<font color="#000080">.</font>DS <font color="#000080">:= </font>r<font color="#000080">.</font>BX<font color="#000080">;
  </font>GetDiskCacheStats <font color="#000080">:= </font>r<font color="#000080">.</font>AL<font color="#000080">;
  </font><font color="#FF0000"><b>if </b></font>r<font color="#000080">.</font>AL <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>then
    begin
      </b></font>move<font color="#000080">(</font>ReplyPacket<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">],</font>DiskCacheStats<font color="#000080">,</font><font color="#800000">78</font><font color="#000080">);
      </font><font color="#FF0000"><b>with </b></font>DiskCacheStats <font color="#FF0000"><b>do
        begin

            </b></font>systemElapsedTime        <font color="#000080">:= </font>GetLong<font color="#000080">(</font>Addr<font color="#000080">(</font>systemElapsedTime        <font color="#000080">));
            </font>cacheBufferCount         <font color="#000080">:= </font>GetWord<font color="#000080">(</font>Addr<font color="#000080">(</font>cacheBufferCount         <font color="#000080">));
            </font>cacheBufferSize          <font color="#000080">:= </font>GetWord<font color="#000080">(</font>Addr<font color="#000080">(</font>cacheBufferSize          <font color="#000080">));
            </font>dirtyCacheBuffers        <font color="#000080">:= </font>GetWord<font color="#000080">(</font>Addr<font color="#000080">(</font>dirtyCacheBuffers        <font color="#000080">));
            </font>cacheReadRequests        <font color="#000080">:= </font>GetLong<font color="#000080">(</font>Addr<font color="#000080">(</font>cacheReadRequests        <font color="#000080">));
            </font>cacheWriteRequests       <font color="#000080">:= </font>GetLong<font color="#000080">(</font>Addr<font color="#000080">(</font>cacheWriteRequests       <font color="#000080">));
            </font>cacheHits                <font color="#000080">:= </font>GetLong<font color="#000080">(</font>Addr<font color="#000080">(</font>cacheHits                <font color="#000080">));
            </font>cacheMisses              <font color="#000080">:= </font>GetLong<font color="#000080">(</font>Addr<font color="#000080">(</font>cacheMisses              <font color="#000080">));
            </font>physicalReadRequests     <font color="#000080">:= </font>GetLong<font color="#000080">(</font>Addr<font color="#000080">(</font>physicalReadRequests     <font color="#000080">));
            </font>physicalWriteRequests    <font color="#000080">:= </font>GetLong<font color="#000080">(</font>Addr<font color="#000080">(</font>physicalWriteRequests    <font color="#000080">));
            </font>physicalReadErrors       <font color="#000080">:= </font>GetWORD<font color="#000080">(</font>Addr<font color="#000080">(</font>physicalReadErrors       <font color="#000080">));
            </font>physicalWriteErrors      <font color="#000080">:= </font>GetWORD<font color="#000080">(</font>Addr<font color="#000080">(</font>physicalWriteErrors      <font color="#000080">));
            </font>cacheGetRequests         <font color="#000080">:= </font>GetLong<font color="#000080">(</font>Addr<font color="#000080">(</font>cacheGetRequests         <font color="#000080">));
            </font>cacheFullWriteRequests   <font color="#000080">:= </font>GetLong<font color="#000080">(</font>Addr<font color="#000080">(</font>cacheFullWriteRequests   <font color="#000080">));
            </font>cachePartialWriteRequests<font color="#000080">:= </font>GetLong<font color="#000080">(</font>Addr<font color="#000080">(</font>cachePartialWriteRequests<font color="#000080">));
            </font>backgroundDirtyWrites    <font color="#000080">:= </font>GetLong<font color="#000080">(</font>Addr<font color="#000080">(</font>backgroundDirtyWrites    <font color="#000080">));
            </font>backgroundAgedWrites     <font color="#000080">:= </font>GetLong<font color="#000080">(</font>Addr<font color="#000080">(</font>backgroundAgedWrites     <font color="#000080">));
            </font>totalCacheWrites         <font color="#000080">:= </font>GetLong<font color="#000080">(</font>Addr<font color="#000080">(</font>totalCacheWrites         <font color="#000080">));
            </font>cacheAllocations         <font color="#000080">:= </font>GetLong<font color="#000080">(</font>Addr<font color="#000080">(</font>cacheAllocations         <font color="#000080">));
            </font>thrashingCount           <font color="#000080">:= </font>GetWORD<font color="#000080">(</font>Addr<font color="#000080">(</font>thrashingCount           <font color="#000080">));
            </font>LRUBlockWasDirtyCount    <font color="#000080">:= </font>GetWORD<font color="#000080">(</font>Addr<font color="#000080">(</font>LRUBlockWasDirtyCount    <font color="#000080">));
            </font>readBeyondWriteCount     <font color="#000080">:= </font>GetWORD<font color="#000080">(</font>Addr<font color="#000080">(</font>readBeyondWriteCount     <font color="#000080">));
            </font>fragmentedWriteCount     <font color="#000080">:= </font>GetWORD<font color="#000080">(</font>Addr<font color="#000080">(</font>fragmentedWriteCount     <font color="#000080">));
            </font>cacheHitOnUnavailCount   <font color="#000080">:= </font>GetWORD<font color="#000080">(</font>Addr<font color="#000080">(</font>cacheHitOnUnavailCount   <font color="#000080">));
            </font>cacheBlockScrappedCount  <font color="#000080">:= </font>GetWORD<font color="#000080">(</font>Addr<font color="#000080">(</font>cacheBlockScrappedCount  <font color="#000080">));
         </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>GetServerLANIOStats<font color="#000080">( </font><font color="#FF0000"><b>Var </b></font>ServerLANIOStats <font color="#000080">: </font>ServerLANIO <font color="#000080">) : </font>byte<font color="#000080">;
</font><font color="#FF0000"><b>Var
  </b></font>r <font color="#000080">: </font>registers<font color="#000080">;
  </font>SendPacket  <font color="#000080">:  </font><font color="#FF0000"><b>array </b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">003</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>byte<font color="#000080">;
  </font>ReplyPacket <font color="#000080">:  </font><font color="#FF0000"><b>array </b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">068</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>byte<font color="#000080">;
  </font>WordPtr     <font color="#000080">: ^</font>Word<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>SendPacket<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">] := </font><font color="#800000">$E7</font><font color="#000080">;
  </font>WordPtr <font color="#000080">:= </font>addr<font color="#000080">(</font>SendPacket<font color="#000080">);
  </font>WordPtr<font color="#000080">^ := </font><font color="#800000">1</font><font color="#000080">;
  </font>WordPtr  <font color="#000080">:= </font>addr<font color="#000080">(</font>ReplyPacket<font color="#000080">);
  </font>WordPtr<font color="#000080">^ := </font><font color="#800000">66</font><font color="#000080">;

  </font>r<font color="#000080">.</font>BX <font color="#000080">:= </font>r<font color="#000080">.</font>DS<font color="#000080">;
  </font>r<font color="#000080">.</font>AH <font color="#000080">:= </font><font color="#800000">$0E3</font><font color="#000080">;
  </font>r<font color="#000080">.</font>DS <font color="#000080">:= </font>SEG<font color="#000080">(</font>SendPacket<font color="#000080">);
  </font>r<font color="#000080">.</font>SI <font color="#000080">:= </font>OFS<font color="#000080">(</font>SendPacket<font color="#000080">);
  </font>r<font color="#000080">.</font>ES <font color="#000080">:= </font>SEG<font color="#000080">(</font>ReplyPacket<font color="#000080">);
  </font>r<font color="#000080">.</font>DI <font color="#000080">:= </font>OFS<font color="#000080">(</font>ReplyPacket<font color="#000080">);
  </font>intr<font color="#000080">(</font><font color="#800000">$21</font><font color="#000080">,</font>r<font color="#000080">);
  </font>r<font color="#000080">.</font>DS <font color="#000080">:= </font>r<font color="#000080">.</font>BX<font color="#000080">;
  </font>GetServerLANIOStats <font color="#000080">:= </font>r<font color="#000080">.</font>AL<font color="#000080">;
  </font><font color="#FF0000"><b>if </b></font>r<font color="#000080">.</font>AL <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>then
    begin
      </b></font>move<font color="#000080">(</font>ReplyPacket<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">],</font>ServerLANIOStats<font color="#000080">,</font><font color="#800000">66</font><font color="#000080">);
      </font><font color="#FF0000"><b>with </b></font>ServerLANIOStats <font color="#FF0000"><b>do
        begin
             </b></font>systemElapsedTime              <font color="#000080">:= </font>GetLong<font color="#000080">(</font>Addr<font color="#000080">(</font>systemElapsedTime                <font color="#000080">));
             </font>maxRoutingBuffersAvail         <font color="#000080">:= </font>GetWord<font color="#000080">(</font>Addr<font color="#000080">(</font>maxRoutingBuffersAvail           <font color="#000080">));
             </font>maxRoutingBuffersUsed          <font color="#000080">:= </font>GetWord<font color="#000080">(</font>Addr<font color="#000080">(</font>maxRoutingBuffersUsed            <font color="#000080">));
             </font>routingBuffersInUse            <font color="#000080">:= </font>GetWord<font color="#000080">(</font>Addr<font color="#000080">(</font>routingBuffersInUse              <font color="#000080">));
             </font>totalFileServicePackets        <font color="#000080">:= </font>GetLong<font color="#000080">(</font>Addr<font color="#000080">(</font>totalFileServicePackets          <font color="#000080">));
             </font>fileServicePacketsBuffered     <font color="#000080">:= </font>GetWord<font color="#000080">(</font>Addr<font color="#000080">(</font>fileServicePacketsBuffered       <font color="#000080">));
             </font>invalidConnPacketCount         <font color="#000080">:= </font>GetWord<font color="#000080">(</font>Addr<font color="#000080">(</font>invalidConnPacketCount           <font color="#000080">));
             </font>badLogicalConnCount            <font color="#000080">:= </font>GetWord<font color="#000080">(</font>Addr<font color="#000080">(</font>badLogicalConnCount              <font color="#000080">));
             </font>packetsRcvdDuringProcCount     <font color="#000080">:= </font>GetWord<font color="#000080">(</font>Addr<font color="#000080">(</font>packetsRcvdDuringProcCount       <font color="#000080">));
             </font>reprocessedRequestCount        <font color="#000080">:= </font>GetWord<font color="#000080">(</font>Addr<font color="#000080">(</font>reprocessedRequestCount          <font color="#000080">));
             </font>badSequenceNumberPacketCount   <font color="#000080">:= </font>GetWord<font color="#000080">(</font>Addr<font color="#000080">(</font>badSequenceNumberPacketCount     <font color="#000080">));
             </font>duplicateReplyCount            <font color="#000080">:= </font>GetWord<font color="#000080">(</font>Addr<font color="#000080">(</font>duplicateReplyCount              <font color="#000080">));
             </font>acknowledgementsSent           <font color="#000080">:= </font>GetWord<font color="#000080">(</font>Addr<font color="#000080">(</font>acknowledgementsSent             <font color="#000080">));
             </font>badRequestTypeCount            <font color="#000080">:= </font>GetWord<font color="#000080">(</font>Addr<font color="#000080">(</font>badRequestTypeCount              <font color="#000080">));
             </font>attachDuringProcCount          <font color="#000080">:= </font>GetWord<font color="#000080">(</font>Addr<font color="#000080">(</font>attachDuringProcCount            <font color="#000080">));
             </font>attachWhileAttachingCount      <font color="#000080">:= </font>GetWord<font color="#000080">(</font>Addr<font color="#000080">(</font>attachWhileAttachingCount        <font color="#000080">));
             </font>forgedDetachRequestCount       <font color="#000080">:= </font>GetWord<font color="#000080">(</font>Addr<font color="#000080">(</font>forgedDetachRequestCount         <font color="#000080">));
             </font>badConnNumberOnDetachCount     <font color="#000080">:= </font>GetWord<font color="#000080">(</font>Addr<font color="#000080">(</font>badConnNumberOnDetachCount       <font color="#000080">));
             </font>detachDuringProcCount          <font color="#000080">:= </font>GetWord<font color="#000080">(</font>Addr<font color="#000080">(</font>detachDuringProcCount            <font color="#000080">));
             </font>repliesCanceledCount           <font color="#000080">:= </font>GetWord<font color="#000080">(</font>Addr<font color="#000080">(</font>repliesCanceledCount             <font color="#000080">));
             </font>hopCountDiscardCount           <font color="#000080">:= </font>GetWord<font color="#000080">(</font>Addr<font color="#000080">(</font>hopCountDiscardCount             <font color="#000080">));
             </font>unknownNetDiscardCount         <font color="#000080">:= </font>GetWord<font color="#000080">(</font>Addr<font color="#000080">(</font>unknownNetDiscardCount           <font color="#000080">));
             </font>noDGroupBufferDiscardCount     <font color="#000080">:= </font>GetWord<font color="#000080">(</font>Addr<font color="#000080">(</font>noDGroupBufferDiscardCount       <font color="#000080">));
             </font>outPacketNoBufferDiscardCount  <font color="#000080">:= </font>GetWord<font color="#000080">(</font>Addr<font color="#000080">(</font>outPacketNoBufferDiscardCount    <font color="#000080">));
             </font>IPXNotMyNetworkCount           <font color="#000080">:= </font>GetWord<font color="#000080">(</font>Addr<font color="#000080">(</font>IPXNotMyNetworkCount             <font color="#000080">));
             </font>NetBIOSPropagationCount        <font color="#000080">:= </font>GetLong<font color="#000080">(</font>Addr<font color="#000080">(</font>NetBIOSPropagationCount          <font color="#000080">));
             </font>totalOtherPackets              <font color="#000080">:= </font>GetLong<font color="#000080">(</font>Addr<font color="#000080">(</font>totalOtherPackets                <font color="#000080">));
             </font>totalRoutedPackets             <font color="#000080">:= </font>GetLong<font color="#000080">(</font>Addr<font color="#000080">(</font>totalRoutedPackets               <font color="#000080">));
           </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
          </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>GetServerMiscInformation<font color="#000080">( </font><font color="#FF0000"><b>Var </b></font>ServerMiscInformation <font color="#000080">: </font>ServerMiscInfo<font color="#000080">) : </font>byte<font color="#000080">;
</font><font color="#FF0000"><b>Var
  </b></font>r <font color="#000080">: </font>registers<font color="#000080">;
  </font>SendPacket  <font color="#000080">:  </font><font color="#FF0000"><b>array </b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">003</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>byte<font color="#000080">;
  </font>ReplyPacket <font color="#000080">:  </font><font color="#FF0000"><b>array </b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">058</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>byte<font color="#000080">;
  </font>WordPtr     <font color="#000080">: ^</font>Word<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>SendPacket<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">] := </font><font color="#800000">$E8</font><font color="#000080">;
  </font>WordPtr <font color="#000080">:= </font>addr<font color="#000080">(</font>SendPacket<font color="#000080">);
  </font>WordPtr<font color="#000080">^ := </font><font color="#800000">1</font><font color="#000080">;
  </font>WordPtr  <font color="#000080">:= </font>addr<font color="#000080">(</font>ReplyPacket<font color="#000080">);
  </font>WordPtr<font color="#000080">^ := </font><font color="#800000">56</font><font color="#000080">;

  </font>r<font color="#000080">.</font>BX <font color="#000080">:= </font>r<font color="#000080">.</font>DS<font color="#000080">;
  </font>r<font color="#000080">.</font>AH <font color="#000080">:= </font><font color="#800000">$0E3</font><font color="#000080">;
  </font>r<font color="#000080">.</font>DS <font color="#000080">:= </font>SEG<font color="#000080">(</font>SendPacket<font color="#000080">);
  </font>r<font color="#000080">.</font>SI <font color="#000080">:= </font>OFS<font color="#000080">(</font>SendPacket<font color="#000080">);
  </font>r<font color="#000080">.</font>ES <font color="#000080">:= </font>SEG<font color="#000080">(</font>ReplyPacket<font color="#000080">);
  </font>r<font color="#000080">.</font>DI <font color="#000080">:= </font>OFS<font color="#000080">(</font>ReplyPacket<font color="#000080">);
  </font>intr<font color="#000080">(</font><font color="#800000">$21</font><font color="#000080">,</font>r<font color="#000080">);
  </font>GetServerMiscInformation <font color="#000080">:= </font>r<font color="#000080">.</font>AL<font color="#000080">;
  </font>r<font color="#000080">.</font>DS <font color="#000080">:= </font>r<font color="#000080">.</font>BX<font color="#000080">;
  </font><font color="#FF0000"><b>if </b></font>r<font color="#000080">.</font>AL <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>then
    begin
      </b></font>move<font color="#000080">(</font>ReplyPacket<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">],</font>ServerMiscInformation<font color="#000080">,</font><font color="#800000">56</font><font color="#000080">);
      </font><font color="#FF0000"><b>with </b></font>ServerMiscInformation <font color="#FF0000"><b>do
        begin
             </b></font>systemElapsedTime        <font color="#000080">:= </font>GetLong<font color="#000080">(</font>Addr<font color="#000080">(</font>systemElapsedTime      <font color="#000080">));
             </font>maxBinderyObjectsAvail   <font color="#000080">:= </font>GetWORD<font color="#000080">(</font>Addr<font color="#000080">(</font>maxBinderyObjectsAvail <font color="#000080">));
             </font>maxBinderyObjectsUsed    <font color="#000080">:= </font>GetWORD<font color="#000080">(</font>Addr<font color="#000080">(</font>maxBinderyObjectsUsed  <font color="#000080">));
             </font>binderyObjectsInUse      <font color="#000080">:= </font>GetWORD<font color="#000080">(</font>Addr<font color="#000080">(</font>binderyObjectsInUse    <font color="#000080">));
             </font>serverMemoryInK          <font color="#000080">:= </font>GetWord<font color="#000080">(</font>Addr<font color="#000080">(</font>serverMemoryInK        <font color="#000080">));
             </font>serverWastedMemoryInK    <font color="#000080">:= </font>GetWord<font color="#000080">(</font>Addr<font color="#000080">(</font>serverWastedMemoryInK  <font color="#000080">));
             </font>dynamicAreaCount         <font color="#000080">:= </font>GetWord<font color="#000080">(</font>Addr<font color="#000080">(</font>dynamicAreaCount       <font color="#000080">));
             </font>dynamicSpace1            <font color="#000080">:= </font>GetLong<font color="#000080">(</font>Addr<font color="#000080">(</font>dynamicSpace1          <font color="#000080">));
             </font>maxUsedDynamicSpace1     <font color="#000080">:= </font>GetLong<font color="#000080">(</font>Addr<font color="#000080">(</font>maxUsedDynamicSpace1   <font color="#000080">));
             </font>dynamicSpaceInUse1       <font color="#000080">:= </font>GetLong<font color="#000080">(</font>Addr<font color="#000080">(</font>dynamicSpaceInUse1     <font color="#000080">));
             </font>dynamicSpace2            <font color="#000080">:= </font>GetLong<font color="#000080">(</font>Addr<font color="#000080">(</font>dynamicSpace2          <font color="#000080">));
             </font>maxUsedDynamicSpace2     <font color="#000080">:= </font>GetLong<font color="#000080">(</font>Addr<font color="#000080">(</font>maxUsedDynamicSpace2   <font color="#000080">));
             </font>dynamicSpaceInUse2       <font color="#000080">:= </font>GetLong<font color="#000080">(</font>Addr<font color="#000080">(</font>dynamicSpaceInUse2     <font color="#000080">));
             </font>dynamicSpace3            <font color="#000080">:= </font>GetLong<font color="#000080">(</font>Addr<font color="#000080">(</font>dynamicSpace3          <font color="#000080">));
             </font>maxUsedDynamicSpace3     <font color="#000080">:= </font>GetLong<font color="#000080">(</font>Addr<font color="#000080">(</font>maxUsedDynamicSpace3   <font color="#000080">));
             </font>dynamicSpaceInUse3       <font color="#000080">:= </font>GetLong<font color="#000080">(</font>Addr<font color="#000080">(</font>dynamicSpaceInUse3     <font color="#000080">));
           </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
          </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>GetDiskUtilization<font color="#000080">( </font>VolumeNumber <font color="#000080">: </font>byte<font color="#000080">;
                             </font>ObjectID     <font color="#000080">: </font>LongInt<font color="#000080">;
                             </font><font color="#FF0000"><b>Var </b></font>UsedDirectories <font color="#000080">: </font>Word<font color="#000080">;
                             </font><font color="#FF0000"><b>Var </b></font>UsedFiles       <font color="#000080">: </font>Word<font color="#000080">;
                             </font><font color="#FF0000"><b>Var </b></font>UsedBlocks      <font color="#000080">: </font>Word<font color="#000080">) : </font>byte<font color="#000080">;

</font><font color="#008000"><i>{ &acirc;&igrave; &uml;&auml;&reg;&agrave;&shy;&aelig;&uml;&icirc; &reg;&iexcl; &uml;&aacute;&macr;&reg;&laquo;&igrave;&sect;&reg;&cent;&uml;&uml; &curren;&uml;&aacute;&ordf;}
</i></font><font color="#FF0000"><b>Var
  </b></font>r <font color="#000080">: </font>registers<font color="#000080">;
  </font>SendPacket  <font color="#000080">:  </font><font color="#FF0000"><b>array </b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">08</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>byte<font color="#000080">;
  </font>ReplyPacket <font color="#000080">:  </font><font color="#FF0000"><b>array </b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">13</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>byte<font color="#000080">;
  </font>WordPtr     <font color="#000080">: ^</font>Word<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>SendPacket<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">] := </font><font color="#800000">14</font><font color="#000080">;
  </font>SendPacket<font color="#000080">[</font><font color="#800000">3</font><font color="#000080">] := </font>VolumeNumber<font color="#000080">;
  </font>ObjectID <font color="#000080">:= </font>GetLong<font color="#000080">(</font>Addr<font color="#000080">(</font>ObjectID<font color="#000080">));
  </font>move<font color="#000080">(</font>ObjectID<font color="#000080">,</font>SendPacket<font color="#000080">[</font><font color="#800000">4</font><font color="#000080">],</font><font color="#800000">4</font><font color="#000080">);

  </font>WordPtr <font color="#000080">:= </font>addr<font color="#000080">(</font>SendPacket<font color="#000080">);
  </font>WordPtr<font color="#000080">^ := </font><font color="#800000">6</font><font color="#000080">;
  </font>WordPtr  <font color="#000080">:= </font>addr<font color="#000080">(</font>ReplyPacket<font color="#000080">);
  </font>WordPtr<font color="#000080">^ := </font><font color="#800000">11</font><font color="#000080">;

  </font>r<font color="#000080">.</font>BX <font color="#000080">:= </font>r<font color="#000080">.</font>DS<font color="#000080">;
  </font>r<font color="#000080">.</font>AH <font color="#000080">:= </font><font color="#800000">$0E3</font><font color="#000080">;
  </font>r<font color="#000080">.</font>DS <font color="#000080">:= </font>SEG<font color="#000080">(</font>SendPacket<font color="#000080">);
  </font>r<font color="#000080">.</font>SI <font color="#000080">:= </font>OFS<font color="#000080">(</font>SendPacket<font color="#000080">);
  </font>r<font color="#000080">.</font>ES <font color="#000080">:= </font>SEG<font color="#000080">(</font>ReplyPacket<font color="#000080">);
  </font>r<font color="#000080">.</font>DI <font color="#000080">:= </font>OFS<font color="#000080">(</font>ReplyPacket<font color="#000080">);
  </font>intr<font color="#000080">(</font><font color="#800000">$21</font><font color="#000080">,</font>r<font color="#000080">);
  </font>GetDiskUtilization <font color="#000080">:= </font>r<font color="#000080">.</font>AL<font color="#000080">;
  </font>r<font color="#000080">.</font>DS <font color="#000080">:= </font>r<font color="#000080">.</font>BX<font color="#000080">;
  </font><font color="#FF0000"><b>if </b></font>r<font color="#000080">.</font>AL <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>then
    begin
      </b></font>UsedDirectories <font color="#000080">:= </font>GetWord<font color="#000080">(</font>Addr<font color="#000080">(</font>ReplyPacket<font color="#000080">[</font><font color="#800000">7</font><font color="#000080">]));
      </font>UsedFiles       <font color="#000080">:= </font>GetWord<font color="#000080">(</font>Addr<font color="#000080">(</font>ReplyPacket<font color="#000080">[</font><font color="#800000">9</font><font color="#000080">]));
      </font>UsedBlocks      <font color="#000080">:= </font>GetWord<font color="#000080">(</font>Addr<font color="#000080">(</font>ReplyPacket<font color="#000080">[</font><font color="#800000">11</font><font color="#000080">]));
     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>end</b></font><font color="#000080">.












</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to NETWORK SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0043.PAS">Original</a><b>]</b></p></body>
</html>
